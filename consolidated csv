import csv
import glob
from openpyxl import Workbook

# Create workbook
wb = Workbook()
wb.remove(wb.active)  # remove default sheet

csv_files = glob.glob("path/to/csv_folder/*.csv")

for file in csv_files:
    sheet_name = file.split("/")[-1].replace(".csv", "")[:31]  # Excel max sheet name = 31 chars
    ws = wb.create_sheet(title=sheet_name)

    with open(file, newline="", encoding="utf-8") as f:
        reader = csv.reader(f)
        for row in reader:
            ws.append(row)

wb.save("consolidated.xlsx")
print("âœ… Fast consolidated file created")
