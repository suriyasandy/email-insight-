def offline_nltk_pipeline(text, nltk_path=r"C:\path\to\nltk_data"):
    import nltk, os, pickle
    nltk.data.path.append(nltk_path)

    # Load punkt directly
    punkt_path = os.path.join(nltk_path, "tokenizers", "punkt", "english.pickle")
    with open(punkt_path, "rb") as f:
        sent_tokenizer = pickle.load(f)

    from nltk.tokenize import TreebankWordTokenizer
    from nltk import pos_tag, ne_chunk

    word_tokenizer = TreebankWordTokenizer()

    results = []
    for sent in sent_tokenizer.tokenize(text):
        tokens = word_tokenizer.tokenize(sent)
        pos_tags = pos_tag(tokens)
        ner_tree = ne_chunk(pos_tags)
        results.append({
            "sentence": sent,
            "tokens": tokens,
            "pos": pos_tags,
            "ner": ner_tree
        })
    return results


# Example usage
text = "Barack Obama was born in Hawaii. He was elected president in 2008."
pipeline_output = offline_nltk_pipeline(text)
for step in pipeline_output:
    print(step)
